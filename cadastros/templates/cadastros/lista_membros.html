{% extends 'cadastros/base.html' %}

{% block title %}Dashboard - SGC{% endblock %}

{% block content %}
<style>
    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    .dashboard-card {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 20px;
    }
    .dashboard-card h3 {
        margin-top: 0;
        font-size: 1rem;
        color: #6c757d;
        display: flex;
        align-items: center;
    }
    .dashboard-card .icon {
        font-size: 1.5rem;
        margin-right: 10px;
    }
    .dashboard-card .value {
        font-size: 2.2rem;
        font-weight: bold;
        color: #003366;
    }
    .dashboard-card .value a {
        color: inherit;
        text-decoration: none;
    }
    .saldo-positivo { color: #28a745; }
    .saldo-negativo { color: #dc3545; }
    .aniversariantes-lista {
        list-style: none;
        padding: 0;
        margin: 0;
        font-size: 0.9em;
    }
    .aniversariantes-lista li {
        padding: 2px 0;
    }
    
    .table-responsive { width: 100%; overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }

    .member-name-link {
        font-weight: 600;
        color: #003366;
        text-decoration: none;
        transition: color 0.2s ease-in-out;
    }
    .member-name-link:hover {
        color: #0055a4;
        text-decoration: underline;
    }
</style>

<h1>Dashboard</h1>

<div class="dashboard-grid">
    <div class="dashboard-card">
        <h3><span class="icon">üë•</span>Total de Membros Ativos</h3>
        <p class="value">{{ total_membros }}</p>
    </div>

    <div class="dashboard-card">
        <h3><span class="icon">üí∞</span>Saldo Atual do Caixa</h3>
        <p class="value {% if saldo_caixa >= 0 %}saldo-positivo{% else %}saldo-negativo{% endif %}">
            R$ {{ saldo_caixa|floatformat:2 }}
        </p>
    </div>

    <div class="dashboard-card">
        <h3><span class="icon">‚ö†Ô∏è</span>Autoriza√ß√µes Pendentes</h3>
        <p class="value">
            <a href="{% url 'lista_autorizacoes' %}">{{ autorizacoes_pendentes }}</a>
        </p>
    </div>

    <div class="dashboard-card">
        <h3><span class="icon">üéÇ</span>Pr√≥ximos Aniversariantes</h3>
        <ul class="aniversariantes-lista">
            {% for aniversariante in aniversariantes %}
                <li>
                    {{ aniversariante.nome_completo }} 
                    ({{ aniversariante.data_nascimento|date:"d/m" }})
                </li>
            {% empty %}
                <li>Nenhum anivers√°rio nos pr√≥ximos 30 dias.</li>
            {% endfor %}
        </ul>
    </div>
</div>

<hr class="my-4">

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Lista de Membros</h2>
    <a href="{% url 'membro_create' %}" class="btn" style="background-color: #003366; color: white;">+ Adicionar Membro</a>
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead class="table-light">
            <tr>
                <th>Nome Completo</th>
                <th>Cargo</th>
                <th>Unidade</th>
                <th>Classe Atual</th>
            </tr>
        </thead>
        <tbody>
            {% for membro in membros %}
            <tr>
                <td>
                    <a href="{% url 'detalhe_membro' pk=membro.pk %}" class="member-name-link">
                        {{ membro.nome_completo }}
                    </a>
                </td>
                <td>{{ membro.get_cargo_display }}</td>
                <td>{{ membro.unidade.nome|default:"-" }}</td>
                <td>{{ membro.classe_atual.nome|default:"-" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center">Nenhum membro cadastrado ainda.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}