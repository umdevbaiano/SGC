<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Relatório de Autorizações de Saída</title>
    <style>
        body { font-family: sans-serif; font-size: 10pt; }
        h1 { text-align: center; color: #003366; }
        .data-relatorio { text-align: center; margin-bottom: 25px; }
        .autorizacao-card { border: 1px solid #ccc; border-radius: 5px; padding: 10px; margin-bottom: 10px; page-break-inside: avoid; }
        .info-membro h3 { margin: 0 0 5px 0; font-size: 12pt; }
        .info-membro p { margin: 0; color: #6c757d; font-size: 9pt; }
        .status-tag { font-weight: bold; }
        .tag-enviado { color: green; }
        .tag-pendente { color: red; }
        .tag-na { color: #6c757d; }
        .documentos-lista { margin-top: 8px; font-size: 9pt; }
    </style>
</head>
<body>
    <h1>Relatório de Autorizações de Saída</h1>
    <p class="data-relatorio">Gerado em: {{ data_hoje|date:"d/m/Y" }}</p>

    {% for membro in membros %}
    <div class="autorizacao-card">
        <div class="info-membro">
            <h3>{{ membro.nome_completo }}</h3>
            <p>{{ membro.unidade.nome|default:"Sem unidade" }} | {{ membro.idade }} anos</p>
        </div>
        <hr style="border: 0; border-top: 1px solid #eee; margin: 8px 0;">
        <div class="info-status">
            {% if membro.idade >= 18 %}
                <span class="status-tag tag-na">Status: Não Aplicável</span>
            {% else %}
                {% if membro.autorizacoes.all %}
                    <span class="status-tag tag-enviado">Status: Enviado</span>
                    <div class="documentos-lista">
                        <strong>Documentos:</strong>
                        <ul>
                        {% for autorizacao in membro.autorizacoes.all %}
                            <li>{{ autorizacao.evento }}</li>
                        {% endfor %}
                        </ul>
                    </div>
                {% else %}
                    <span class="status-tag tag-pendente">Status: Pendente</span>
                {% endif %}
            {% endif %}
        </div>
    </div>
    {% endfor %}
</body>
</html>