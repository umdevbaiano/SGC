<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Relatório de Unidades</title>
    <style>
        @page { size: A4; margin: 2cm; }
        body { font-family: sans-serif; }
        h1, h2 { color: #003366; }
        h1 { text-align: center; }
        .data-relatorio { text-align: center; margin-bottom: 25px; }
        .unidade-bloco { 
            border: 1px solid #ddd; 
            border-radius: 8px; 
            padding: 15px; 
            margin-bottom: 20px;
            page-break-inside: avoid;
        }
        ul { list-style-type: none; padding-left: 10px; }
        li { padding: 4px 0; }
    </style>
</head>
<body>
    <h1>Relatório de Unidades</h1>
    <p class="data-relatorio">Gerado em: {{ data_hoje|date:"d/m/Y" }}</p>

    {% for unidade in unidades %}
    <div class="unidade-bloco">
        <h2>Unidade: {{ unidade.nome }} ({{ unidade.get_sexo_display }})</h2>
        <h4>Membros:</h4>
        <ul>
            {% for membro in unidade.membro_set.all %}
                <li>{{ membro.nome_completo }} - ({{ membro.get_cargo_display }})</li>
            {% empty %}
                <li>Nenhum membro nesta unidade.</li>
            {% endfor %}
        </ul>
    </div>
    {% endfor %}
</body>
</html>